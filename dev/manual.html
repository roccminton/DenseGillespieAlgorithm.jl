<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual · DenseGillespieAlgorithm.jl</title><meta name="title" content="Manual · DenseGillespieAlgorithm.jl"/><meta property="og:title" content="Manual · DenseGillespieAlgorithm.jl"/><meta property="twitter:title" content="Manual · DenseGillespieAlgorithm.jl"/><meta name="description" content="Documentation for DenseGillespieAlgorithm.jl."/><meta property="og:description" content="Documentation for DenseGillespieAlgorithm.jl."/><meta property="twitter:description" content="Documentation for DenseGillespieAlgorithm.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="DGAPackage.html"><img src="assets/logo.png" alt="DenseGillespieAlgorithm.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="DGAPackage.html">DenseGillespieAlgorithm.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="DGAPackage.html">Home</a></li><li class="is-active"><a class="tocitem" href="manual.html">Manual</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Setting-up-the-model-functions"><span>Setting up the model functions</span></a></li><li><a class="tocitem" href="#Setting-up-the-model-parameter,-population-history-and-initial-population"><span>Setting up the model parameter, population history and initial population</span></a></li><li><a class="tocitem" href="#Execute-the-simulation"><span>Execute the simulation</span></a></li><li><a class="tocitem" href="#Customized-statistics"><span>Customized statistics</span></a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="perform.html">Performance Tips</a></li><li><a class="tocitem" href="index.html">Public API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="manual.html">Manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="manual.html">Manual</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/roccminton/DenseGillespieAlgorithm.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/roccminton/DenseGillespieAlgorithm.jl/blob/main/docs/src/manual.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Manual"><a class="docs-heading-anchor" href="#Manual">Manual</a><a id="Manual-1"></a><a class="docs-heading-anchor-permalink" href="#Manual" title="Permalink"></a></h1><p>The DenseGillespieAlgorithm framework is designed to assist researchers in simulating their complex models in an exact stochastic manner. It is the responsibility of the user to implement all model-specific functions, such as those pertaining to birth and death events or rate functions. Once this has been done, the framework executes the Gillespie Algorithm and saves the population history. The following section provides an overview of the main function of this package.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><h3 id="Install-from-GitHub"><a class="docs-heading-anchor" href="#Install-from-GitHub">Install from GitHub</a><a id="Install-from-GitHub-1"></a><a class="docs-heading-anchor-permalink" href="#Install-from-GitHub" title="Permalink"></a></h3><p>You can install the package directly from this GitHub repository:</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;https://github.com/roccminton/DenseGillespieAlgorithm.jl&quot;)</code></pre><h3 id="Install-from-Julia"><a class="docs-heading-anchor" href="#Install-from-Julia">Install from Julia</a><a id="Install-from-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Install-from-Julia" title="Permalink"></a></h3><p>Once the package is registered in the official Julia package registry, you can install it via:</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;DenseGillespieAlgorithm&quot;)</code></pre><p>This will install the latest stable version of the package and all required dependencies.</p><div class="admonition is-info"><header class="admonition-header">Package dependencies</header><div class="admonition-body"><p>When loading the package directly from GitHub, the following packages must be available <code>Random, Distributions, ProgressMeter, SparseArrays</code></p></div></div><h2 id="Setting-up-the-model-functions"><a class="docs-heading-anchor" href="#Setting-up-the-model-functions">Setting up the model functions</a><a id="Setting-up-the-model-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-up-the-model-functions" title="Permalink"></a></h2><p>The initial step is to define all interaction functions for the model. In population models, these are typically limited to two: birth and death. However, there is no upper limit on the number of interactions that can be included. As the number of fundamentally different interactions increases, the efficiency of the algorithm is reduced. The framework is speciallised to a small number of different events.</p><p>Subsequently, all the interaction functions should be incorporated into a single execute function. This function must accept three inputs: an index, the current population state, and the model parameter. The index specifies which of the defined events should be executed. The current population state is then modified by the event functions. </p><pre><code class="language-julia hljs">    execute!(i,x,par)</code></pre><p>Next we need to define the rates function. There must be as many rates as there are interaction events. Therefore the variable <code>initrates</code> is usually a <code>Vector</code> with as many entries as there are events. The rates function takes as input the initial rates, the current population state and the additional model parameters. The function should calculate the rates according to the population state and modify the <code>initrates</code> accordingly.</p><pre><code class="language-julia hljs">    rates!(initrates,x,par)</code></pre><div class="admonition is-info"><header class="admonition-header">Function names</header><div class="admonition-body"><p>The function name may be designated as desired, as they are passed to the core function. The nomenclature is inconsequential.</p></div></div><div class="admonition is-danger"><header class="admonition-header">Function signature</header><div class="admonition-body"><p>Nevertheless, it is crucial to maintain the original function signature, which entails retaining the sequence and the number of arguments as they are called within the algorithmic structure.</p></div></div><div class="admonition is-success"><header class="admonition-header">Parameter variable</header><div class="admonition-body"><p>There are no restrictions on the parameter variable <code>par</code>. Any additional information used to calculate rates and to change the current population state can be added to the parameter element that is passed through all functions. For example, if you want to know the current time of the simulation within the functions you run for time-inhomogeneous models, you could add this to your model parameter.</p></div></div><h2 id="Setting-up-the-model-parameter,-population-history-and-initial-population"><a class="docs-heading-anchor" href="#Setting-up-the-model-parameter,-population-history-and-initial-population">Setting up the model parameter, population history and initial population</a><a id="Setting-up-the-model-parameter,-population-history-and-initial-population-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-up-the-model-parameter,-population-history-and-initial-population" title="Permalink"></a></h2><p>The final step before running the simulation is to define the model parameters, including the time horizon of the simulation and the initial population state, as well as a blank population history.</p><p>The time horizon of the simulation is tipically a <code>UnitRange</code>, but can be anything that can be enumerated.  The type of initial population state should correspond to the functionalities defiend in the function <code>rates!</code> and <code>execute!</code> as they use and modify this type.  The empty population history should also match the type of population state, as it will be copied into the population history. In addition, if the population history is a vector or matrix, it should be at least as long as the time horizon. You can customise the saving process with your own Statistics! function. In this case, you will have to adapt the coupling history to the functionalities of this function. For more details, see <a href="manual.html#Customized-statistics">Customized statistics</a></p><h2 id="Execute-the-simulation"><a class="docs-heading-anchor" href="#Execute-the-simulation">Execute the simulation</a><a id="Execute-the-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Execute-the-simulation" title="Permalink"></a></h2><p>With everything in place, it is time to run the simulations. To do this, call the <code>run_gillespie!</code> function from the package. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DenseGillespieAlgorithm.run_gillespie!" href="#DenseGillespieAlgorithm.run_gillespie!"><code>DenseGillespieAlgorithm.run_gillespie!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">    run_gillespie!(time,n₀,par,execute!,rates!,initrates,population_history[,hstart=0,statistic!])</code></pre><p>Run a exact stochastic simulation, return and fill the <code>population_history</code>.</p><p><strong>Arguments</strong></p><ul><li><code>time::AbstracVector</code>: time interval for the simulation</li><li><code>n₀</code>: initial population state</li><li><code>par</code>: additional parameter (gets passed to <code>execute!</code> and <code>rates!</code>)</li><li><code>execute!</code>: execute function</li><li><code>rates!</code>: rates function</li><li><code>initrates</code>: initial rates</li><li><code>population_history</code>: empty population history</li><li><code>hstart=0</code>: time shift for parameter change <em>(opitonal)</em></li><li><code>statistic!</code>: additional statistic function <em>(optional)</em></li></ul><p><strong>Extended help</strong></p><ul><li>Note that <code>n₀,initrates,population_history</code> all three get modified during the simulation.</li><li>The algorithm expects the <code>execute!</code> function to have the following signature   <code>julia   execute!(i::Number,n₀,par)</code>   where the <code>i</code> is the event that gets executed and the population state <code>n₀</code> gets modified accordingly.   The only exception is when the <code>initrates</code> are given as a dictionary. In that case the signature is <code>execute!(i,trait,n₀,initrates,par)</code>, where &#39;trait&#39;   is the key that is modified.</li><li>The algorithm expects the <code>rates!</code> function to have the following signature   <code>julia   rates!(initrates,n₀,par)</code>   where the rates get modified according to the current population state given in <code>n₀</code>.</li><li>The algorithm expects the <code>statistic!</code> function to have the following signature   <code>julia   statistic!(population_hist,t,n₀,par)</code>   where the population history gets modified at position <code>t</code> with the current population state <code>n₀</code>.</li><li>Note that the <code>population_history</code> needs to be accessible via index from 1 to <code>length(time)</code>, or if <code>hstart</code> is given from <code>1+hstart</code> to <code>length(time)+hstart</code>. Unless a specified <code>statistic!</code> function is given.</li><li>Note that the initial population state <code>n₀</code> must match the <code>population_history</code> in the sense that <code>population_history :: Vector{typeof(n₀)}</code>.  Unless a specified <code>statistic!</code> function is given.</li><li>The parameter variable <code>par</code> is passed through all functions (<code>execute!,rates!,statistics!</code>), thereby affording the user additional flexibility.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/roccminton/DenseGillespieAlgorithm.jl/blob/efbc4c108192a58c95505f4ed6c098868f2e6a9d/src/functions.jl#L1-L39">source</a></section></article><p>Once the simulation has reached its conclusion, the modified population history is returned for further analysis.</p><h2 id="Customized-statistics"><a class="docs-heading-anchor" href="#Customized-statistics">Customized statistics</a><a id="Customized-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Customized-statistics" title="Permalink"></a></h2><p>For many high-dimensional models, the exact configuration at any given time is too much information. In many cases only summery statistics are needed. To avoid accumulating too much data during the runtime of the algorithm that is not needed afterwards, you can define your own <code>statistics!</code> function. In this case, only the information you want to collect is stored for further analysis.</p><p>As for the <code>rates!</code> and <code>execute!</code> functions, the function signature is of particular significance. The function accepts as input the population history, which is modified by the function and the current time index, hence the index at which the statistics of the current population state are saved. Additionally, the current state and the model parameter are required.</p><pre><code class="language-julia hljs">    statistics!(population_history,t,x,par)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="DGAPackage.html">« Home</a><a class="docs-footer-nextpage" href="examples.html">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 25 September 2024 12:38">Wednesday 25 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
